{"componentChunkName":"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js","path":"/nodeJs_amadeus/nodejs_amadeus/","webpackCompilationHash":"9fc5e91edb1659e8ed19","result":{"data":{"site":{"siteMetadata":{"title":"A developer journey","social":[{"name":"twitter","url":"https://twitter.com/theophile_vast"},{"name":"github","url":"https://github.com/tvast"}]}},"blogPost":{"__typename":"MdxBlogPost","id":"5b3438d4-0078-5641-ac32-6723f542588d","excerpt":"NodeJS app for working with anadeus app Hello folks. Today we'll learn how to start your proof of concept for a disruptive travel agency…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Node JS app for amadeus API\",\n  \"date\": \"2019-01-07T00:00:00.000Z\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"nodejs-app-for-working-with-anadeus-app\"\n  }, \"NodeJS app for working with anadeus app\"), mdx(\"p\", null, \"Hello folks. Today we\\u2019ll learn how to start your proof of concept for a disruptive travel agency with the self service Amadeus API.\"), mdx(\"p\", null, \"The architecture is pretty simple. You get the token from the amadeus API with your credentials given with you opened account at \", mdx(\"a\", {\n    href: \"https://developers.amadeus.com/register\"\n  }, \"Amadeus\"), \". ANd then you can ask the api to give you flight offers, inspiration travels and many other content from the Amadeus API.\"), mdx(\"p\", null, \"FIrst thing first we need a simple Node js server to get it running \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"var express = require('express')\\n\\nconst bodyParser = require('body-parser');\\n\\nconst fetch = require('node-fetch');\\n\\n app = express(),\\n port = process.env.PORT || 3000;\\n\\napp.use(allowCrossDomain);\\n\\napp.listen(port);\\n// console.log(tree)\\nconsole.log('Amadeus RESTful API server started on: ' + port);\\n\")), mdx(\"p\", null, \"This code is an instance of an express server. Who listen on the port 3000. Here is the package json to install the depedencies :\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"{\\n  \\\"name\\\": \\\"Amadeus\\\",\\n  \\\"version\\\": \\\"1.0.0\\\",\\n  \\\"description\\\": \\\"parse folder of ventyas to generate jSon\\\",\\n  \\\"main\\\": \\\"server.js\\\",\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"nodemon server.js\\\",\\n    \\\"test\\\": \\\"echo \\\\\\\"Error: no test specified\\\\\\\" && exit 1\\\"\\n  },\\n  \\\"author\\\": \\\"theophile vast\\\",\\n  \\\"license\\\": \\\"ISC\\\",\\n  \\\"devDependencies\\\": {\\n    \\\"express\\\": \\\"^4.17.1\\\",\\n    \\\"nodemon\\\": \\\"^1.19.4\\\"\\n  },\\n  \\\"dependencies\\\": {\\n    \\\"amadeus\\\": \\\"^3.2.0\\\",\\n    \\\"dree\\\": \\\"^2.1.11\\\",\\n    \\\"glob\\\": \\\"^7.1.4\\\",\\n    \\\"node-fetch\\\": \\\"^2.6.0\\\",\\n    \\\"node-static\\\": \\\"^0.7.11\\\",\\n    \\\"request\\\": \\\"^2.88.0\\\",\\n    \\\"serve-index\\\": \\\"^1.9.1\\\"\\n  }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"first-call-to-the-api-get-the-token\"\n  }, \"First call to the API get the token\"), mdx(\"p\", null, \"If you are familiar with Oauth it will be easy for you to navigat into the API of Amadeus. To get the token we add our url to the API, and we will fetch it to get the token.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"const uriAuth =\\\"https://test.api.amadeus.com/v1/security/oauth2/token\\\" \\n\\n\\n//get grant\\nlet headers= {\\n      // 'Content-Type': 'application/json'   \\n      'Content-Type': 'application/x-www-form-urlencoded',\\n     };\\n\\nlet body = {\\n   \\\"grant_type\\\": \\\"client_credentials\\\",\\n   \\\"client_id\\\": \\\"YOUR_CLIENT_ID\\\",\\n  \\\"client_secret\\\": \\\"YOUR_CLIENT_SECRET\\\",\\n  \\n}\\n\\nlet token=\\\"\\\";\\n\\nfetch(uriAuth, { method: 'POST', \\n  headers: headers, \\n  body: 'grant_type=client_credentials&client_id=' + body.client_id + '&client_secret=' + body.client_secret\\n})\\n  .then((res) => {\\n     return res.json()\\n})\\n.then((json) => {\\n  token=json.access_token;\\n  console.log(token);\\n  // Do something with the returned data.\\n});\\n\\n\")), mdx(\"p\", null, \"Here we fetch the url passing the credentials into the body of the request as a string. And we save the token into a variable.\"), mdx(\"p\", null, \"You can check the documentation if you get any error.\"), mdx(\"h2\", {\n    \"id\": \"ask-the-api--flight-offer-search\"\n  }, \"Ask the API : Flight offer search\"), mdx(\"p\", null, \"IF you are here it means that you got the precious token. Congratulations ! Now its time to build your request to post it and retrieve data from the AMadeus flight offer search endpoint.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"let request = {\\n  \\\"currencyCode\\\": \\\"USD\\\",\\n  \\\"originDestinations\\\": [\\n    {\\n      \\\"id\\\": \\\"1\\\",\\n      \\\"originLocationCode\\\": \\\"MAD\\\",\\n      \\\"destinationLocationCode\\\": \\\"PAR\\\",\\n      \\\"departureDateTimeRange\\\": {\\n        \\\"date\\\": departure,\\n        \\\"time\\\": \\\"10:00:00\\\"\\n      }\\n    },\\n   ],\\n  \\\"travelers\\\": [\\n    {\\n      \\\"id\\\": \\\"1\\\",\\n      \\\"travelerType\\\": \\\"ADULT\\\",\\n      \\\"fareOptions\\\": [\\n        \\\"STANDARD\\\"\\n      ]\\n    },\\n  ],\\n  \\\"sources\\\": [\\n    \\\"GDS\\\"\\n  ],\\n  \\\"searchCriteria\\\": {\\n    \\\"maxFlightOffers\\\": 50,\\n    \\\"flightFilters\\\": {\\n      \\\"cabinRestrictions\\\": [\\n        {\\n          \\\"cabin\\\": \\\"BUSINESS\\\",\\n          \\\"coverage\\\": \\\"MOST_SEGMENTS\\\",\\n          \\\"originDestinationIds\\\": [\\n            \\\"1\\\"\\n          ]\\n        }\\n      ],\\n     }\\n  }\\n}\\n\\n\")), mdx(\"p\", null, \"Where departure is the value desired for your search. It can come from a post from any frontend framework with the next code snippets : \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"app.post('/date', function(req, res) {\\n  console.log(req)\\n    departure = req.body.departure;\\n    arrival = req.body.arrival;\\n    console.log(departure+\\\" \\\"+arrival)\\n    res.send(departure + ' ' + arrival);\\n\\n}); \\n\")), mdx(\"p\", null, \"Now you can post your json variable to the api and get some data : \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"let uriFlightOffer = \\\"https://test.api.amadeus.com/v2/shopping/flight-offers\\\"\\n// console.log(request);\\nfetch(uriFlightOffer, { method: 'POST', \\n  headers: header, \\n  body: JSON.stringify(request)\\n})\\n  .then((res) => {\\n     return res.json()\\n})\\n.then((json) => {\\n  // console.log(json);\\n  flightfrommadrid=json.data;\\n  // Do something with the returned data.\\n}); \\n\")), mdx(\"p\", null, \"And if you want to serve your result to a route here is the snippets :\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"app.get('/flight', function(req, res) {\\n  res.send(JSON.stringify(flightfrommadrid));\\n});\\n\")), mdx(\"p\", null, \"the complete code is available on github \", mdx(\"a\", {\n    href: \"https://github.com/tvast/parser-amadeus-test\"\n  }, \"complete code\")), mdx(\"h2\", {\n    \"id\": \"ask-the-api--flight-offer-prices\"\n  }, \"Ask the API : Flight offer prices\"), mdx(\"h2\", {\n    \"id\": \"ask-the-api-flight-create-order\"\n  }, \"Ask the API flight create order\"));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"/nodeJs_amadeus/nodejs_amadeus/","title":"Node JS app for amadeus API","tags":[],"keywords":[],"date":"January 07, 2019"},"previous":null,"next":{"__typename":"MdxBlogPost","id":"55795eca-1401-5d17-b358-5e143e8ce4ed","excerpt":"This is my first post of my journey as a developer. I work in the digital industry since five years now and I found a lot of ressources…","slug":"/begining/begining/","title":"Begining","date":"July 03, 2019"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"5b3438d4-0078-5641-ac32-6723f542588d","nextId":"55795eca-1401-5d17-b358-5e143e8ce4ed"}}}